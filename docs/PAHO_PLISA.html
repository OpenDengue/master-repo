<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>OpenDengue Web: PAHO PLISA cumulative to incident</title>


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
  <link rel="icon" type="image/vnd.microsoft.icon" href="./logo/favicon.ico"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2023-04-25"/>
  <meta property="article:created" itemprop="dateCreated" content="2023-04-25"/>
  <meta name="article:author" content="Joe Clarke &amp; Ahyoung Lim &#10;"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="OpenDengue Web: PAHO PLISA cumulative to incident"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="OpenDengue Web"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="OpenDengue Web: PAHO PLISA cumulative to incident"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["PAHO PLISA cumulative to incident"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Joe Clarke & Ahyoung Lim \n"]}]}]},{"type":"character","attributes":{},"value":["Last update on April 25, 2023"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["html_document"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["number_sections","toc","toc_float","output_dir"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["."]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <style type="text/css">
  @import url('https://fonts.googleapis.com/css?family=Playfair+Display|Asap:400,400i,700,700i|Roboto:400,400i,700,700i&display=swap');

  h1, h2, h3, h4, h5, h6 {
    font-family: "Roboto";
  }

  body {
    font-family: "Roboto;
    color: #595959;
  }

  /* --------------logo-------------------- */

  .distill-site-header .logo img{
    max-height: 30px; /* Makes logo bigger, default was 20px */
  }


  /* --------------Navbar-------------------- */

  .distill-site-header{ 
    padding: 10px 10px;
    background-color: #065D10; /*--linear-gradient(to bottom, rgba(244, 228, 224, 1), rgba(40,92,29,0.5)); */  
    /*background-color: transparent;*/
    font-size: 15px;
    font-family: "Roboto";
    letter-spacing: 2px;
    /*text-transform: uppercase;*/
  }

  /* -------------Footer------------------*/

  .distill-site-footer {
    color: #f7f7f7b0;
    background-color: #1f1f1f;
    margin-top: 0px;
    padding: 50px 20px;
    font-size: 13px;
    letter-spacing: 1px;
    text-transform: uppercase;
    line-height: 12px;
  }
  </style>
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="style.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"PAHO PLISA cumulative to incident","authors":[{"author":"Joe Clarke & Ahyoung Lim \n","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-04-25T00:00:00.000+01:00","citationText":"Lim, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://opendengue.github.io/master-repo/index.html">
<img src="logo/logo3.png" alt="Logo"/>
</a>
<a href="index.html" class="title">OpenDengue Web</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">About</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Methods
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="overview.html">OVERVIEW</a>
<a href="PAHO_PLISA.html">PAHO</a>
<a href="tycho.html">TYCHO</a>
</div>
</div>
<a href="https://github.com/OpenDengue/master-repo">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>PAHO PLISA cumulative to incident</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  <p>Joe Clarke &amp; Ahyoung Lim</p>
  
<br/>Last update on April 25, 2023
</div>

<div class="d-article">
<h1 id="background">Background</h1>
<h2 id="aim">Aim</h2>
<p>From cumulative to incident case counts in the <a href="https://www3.paho.org/data/index.php/en/mnu-topics/indicadores-dengue-en/dengue-nacional-en/252-dengue-pais-ano-en.html">PAHO PLISA Health Information Platform for the Americas dengue database</a></p>
<h2 id="objectives">Objectives</h2>
<ol type="1">
<li>Clean, process and transform 53 downloaded PAHO weekly cumulative datasets for all countries into one dataframe.<br />
</li>
<li>Summarise the data coverage for each country (admin 0 level) in the cumulative total of dengue cases table.<br />
</li>
<li>Summarise the data coverage for each country (admin 0 level) in the incident suspected dengue cases (Non-severe cases by epidemiological week) table.<br />
</li>
<li>Investigate how the data coverage varies according to burden of dengue disease.<br />
</li>
<li>Develop methods to convert cumulative to incident case counts, accounting for gaps in data coverage.</li>
</ol>
<h2 id="rationale">Rationale</h2>
<p>It is important to note that the cumulative datasets are for reports of all dengue cases : suspected, probable, confirmed, non-severe and severe cases, and deaths. probable dengue cases : person who has a fever or history of fever for 2-7 days duration, two or more symptoms of dengue and one serological test positive or epidemiological nexus with confirmed dengue case 14 days before onset of symtpoms.</p>
<p>This dataset, while it has select epidemiological week slider options for all available epidemiological weeks of every yer, the epidemiological week for which information is actually available/reported can differ from that on the slider. Some countries have missing weeks of data.The the extent of missing data varies greatly between countries, and over time. While moving from cumulative to incident weekly counts for countries with 100% reporting of sequential cumulative counts may be straightforward, by subtracting the previous weeks count from the following weeks count, this is not so for countries with missing data. There is already incident data available through the Chart and Epi Curve options, however this is for non-severe cases of dengue only. This is not the same as total of dengue cases as measured in the cumulative table, which is our priority for this dataset.</p>
<p>We want to investigate if this incident dataset can be leveraged to gap-fill the cumulative dataset when moving to incident counts, and what the difference between the two is.</p>
<h1 id="data-preprocessing">Data preprocessing</h1>
<p>PLISA PAHO portal only permits download of all countries cumulative data sets in a week by week fashion, by moving the epidemiological week slider while selecting all countries. These require the file format to be encoded differently, and re-saved in this format for further processing.</p>
<p>The files are loaded and a new directory created for processed data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>file_list</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data/raw_files/PAHO"</span><span class='op'>)</span><span class='op'>)</span>; <span class='va'>file_list</span></span>
<span></span>
<span><span class='va'>old_dir</span><span class='op'>&lt;-</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data/raw_files/PAHO"</span><span class='op'>)</span></span>
<span><span class='va'>new_dir</span><span class='op'>&lt;-</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data/source_files/PAHO"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Encoding &amp; save again</span></span>
<span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>file_list</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span> </span>
<span>  </span>
<span>  <span class='va'>oldfiledir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>old_dir</span>, <span class='st'>"/"</span>, <span class='va'>file_list</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span> </span>
<span>  <span class='va'>newfiledir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>new_dir</span>, <span class='st'>"/"</span>, <span class='va'>file_list</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span></span>
<span>  <span class='va'>fileConn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/connections.html'>file</a></span><span class='op'>(</span><span class='va'>newfiledir</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/writeLines.html'>writeLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='va'>con</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/connections.html'>file</a></span><span class='op'>(</span><span class='va'>oldfiledir</span>, encoding <span class='op'>=</span> <span class='st'>"UCS-2LE"</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>fileConn</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/connections.html'>close</a></span><span class='op'>(</span><span class='va'>fileConn</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>csv_files</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='va'>new_dir</span>, full.names<span class='op'>=</span><span class='cn'>T</span>, recursive<span class='op'>=</span><span class='cn'>F</span>, pattern<span class='op'>=</span><span class='st'>"\\.csv$"</span><span class='op'>)</span> <span class='co'>#directory names for loading files</span></span>
<span></span>
<span><span class='va'>csv_files</span> <span class='op'>&lt;-</span> <span class='va'>csv_files</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>;<span class='va'>csv_files</span></span>
<span><span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>csv_files</span>, <span class='va'>read.table</span>, sep<span class='op'>=</span><span class='st'>"\t"</span>, colClasses <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"character"</span>,<span class='fl'>16</span><span class='op'>)</span>, header<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>merge</span> <span class='op'>&lt;-</span> <span class='fu'>rbindlist</span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Column rename and select</span></span>
<span><span class='va'>all_dt</span> <span class='op'>&lt;-</span> <span class='va'>merge</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>Country.or.Subregion</span>, <span class='va'>Serotype</span>, <span class='va'>Year</span>, <span class='va'>Confirmed</span>, <span class='va'>Deaths</span>, </span>
<span>         <span class='va'>Epidemiological.Week..a.</span>, <span class='va'>Severe.Dengue..d.</span>, <span class='va'>Total.of.Dengue.Cases..b.</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename</span><span class='op'>(</span>adm_0_name <span class='op'>=</span> <span class='va'>Country.or.Subregion</span>,</span>
<span>         year <span class='op'>=</span> <span class='va'>Year</span>, </span>
<span>         epidemiological_week <span class='op'>=</span> <span class='va'>Epidemiological.Week..a.</span>,</span>
<span>         severe_dengue_cumulative <span class='op'>=</span> <span class='va'>Severe.Dengue..d.</span>,</span>
<span>         dengue_total_cumulative <span class='op'>=</span> <span class='va'>Total.of.Dengue.Cases..b.</span><span class='op'>)</span>  <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>epidemiological_week</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"-"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># * AL: why does it have some data with epidemiological week being "-" here? </span></span>
<span></span>
<span><span class='co'>#convert epidemiological week and year to numeric</span></span>
<span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>epidemiological_week</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>epidemiological_week</span><span class='op'>)</span></span>
<span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>year</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>year</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#remove duplicates</span></span>
<span><span class='va'>all_dt</span> <span class='op'>&lt;-</span> <span class='va'>all_dt</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span>, <span class='va'>epidemiological_week</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#add the end date of the cumulative count for each row ("cum_end_date"). </span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span> <span class='va'>all_dt</span><span class='op'>$</span><span class='va'>cum_end_date</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'>epiweekToDate</span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>year</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>all_dt</span><span class='op'>$</span><span class='va'>epidemiological_week</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>d1</span><span class='op'>)</span></span>
<span></span>
<span><span class='op'>}</span> <span class='co'>#*AL: maybe try "lubridate::epiweek()" here? it's faster. </span></span>
<span></span>
<span><span class='co'>#add cum_start_date based on the cum_end_date of the previous row. This is done by lagging cum_end_week because there may be cases where the cumulative count is not reported for consecutive weeks.</span></span>
<span><span class='va'>all_dt</span> <span class='op'>&lt;-</span> <span class='va'>all_dt</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span>, <span class='va'>epidemiological_week</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>cum_start_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lag.html'>lag</a></span><span class='op'>(</span><span class='va'>cum_end_date</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#create "complete" dataset which has a row for every epidemiological week for every year, with NA for the dengue_total count if no data reported for this week. Make sure number of epidemiological weeks in each year is correct according to epidemiological calendars for each year (some have 52 weeks, others have 53).</span></span>
<span><span class='va'>all_dt</span> <span class='op'>&lt;-</span> <span class='va'>all_dt</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/complete.html'>complete</a></span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span>, <span class='va'>epidemiological_week</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>year</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2015</span><span class='op'>:</span><span class='fl'>2019</span>, <span class='fl'>2021</span><span class='op'>:</span><span class='fl'>2022</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='va'>epidemiological_week</span> <span class='op'>==</span> <span class='fl'>53</span><span class='op'>)</span><span class='op'>)</span>  </span>
<span></span>
<span><span class='va'>all_dt</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>tally</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#add cum_end_date again for rows that were missed from the original data but were filled by 'complete' function above. Add the start/end date of epidemiological week for all rows("calendar_start_date" and "calendar_end_date"). </span></span>
<span></span>
<span><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>all_dt</span><span class='op'>$</span><span class='va'>calendar_end_date</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'>epiweekToDate</span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>year</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>all_dt</span><span class='op'>$</span><span class='va'>epidemiological_week</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>d1</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>cum_end_date</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>==</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='kw'>next</span></span>
<span> <span class='va'>all_dt</span><span class='op'>$</span><span class='va'>cum_end_date</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'>epiweekToDate</span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>year</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>all_dt</span><span class='op'>$</span><span class='va'>epidemiological_week</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>d1</span><span class='op'>)</span></span>
<span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># add cum_start_date, calendar_start_date and source_id</span></span>
<span><span class='va'>all_dt</span> <span class='op'>&lt;-</span> <span class='va'>all_dt</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>cum_end_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>cum_end_date</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>cum_start_date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cum_start_date</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'>ymd</span><span class='op'>(</span><span class='va'>cum_end_date</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>6</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>cum_start_date</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>cum_interval <span class='op'>=</span> <span class='fu'>interval</span><span class='op'>(</span><span class='va'>cum_start_date</span>, <span class='va'>cum_end_date</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%/%</a></span> <span class='fu'>weeks</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>calendar_end_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>calendar_end_date</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>calendar_start_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>calendar_end_date</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>6</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>source_id<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>dengue_total_cumulative</span><span class='op'>)</span><span class='op'>==</span><span class='cn'>FALSE</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"all_PAHO_countries_PAHO_2014_to_2022_EW"</span>,<span class='va'>epidemiological_week</span><span class='op'>)</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#summary(all_dt$cum_interval)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#administrative unit codes</span></span>
<span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>adm_0_name</span> <span class='op'>&lt;-</span> <span class='fu'>stri_trans_general</span><span class='op'>(</span><span class='va'>all_dt</span><span class='op'>$</span><span class='va'>adm_0_name</span>,<span class='st'>"Latin-ASCII"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gaul_codes_world</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data/ref_data"</span>, <span class='st'>"gaul_codes_world.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gaul_codes_world</span> <span class='op'>&lt;-</span> <span class='va'>gaul_codes_world</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>ADM0_NAME</span>, <span class='va'>ADM0_CODE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename</span><span class='op'>(</span>adm_0_name <span class='op'>=</span> <span class='va'>ADM0_NAME</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>rename</span><span class='op'>(</span>adm_0_code <span class='op'>=</span> <span class='va'>ADM0_CODE</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#plyr::count(all_dt$adm_0_name) #52 countries</span></span>
<span><span class='co'>#plyr::count(gaul_codes_world$adm_0_name) #273 countries</span></span>
<span></span>
<span><span class='va'>ctry_check</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>all_dt</span>, <span class='va'>gaul_codes_world</span>, by<span class='op'>=</span><span class='st'>"adm_0_name"</span>, all.x<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#check the country names that did not match with gaul names</span></span>
<span><span class='va'>ctry_check</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>adm_0_code</span><span class='op'>)</span><span class='op'>%&gt;%</span> <span class='fu'>tally</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>adm_0_code</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ctry_lookup</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='co'># gaul name to paho name</span></span>
<span><span class='st'>"Turks and Caicos islands"</span> <span class='op'>=</span> <span class='st'>"Turks and Caicos Islands"</span>,</span>
<span><span class='st'>"British Virgin Islands"</span> <span class='op'>=</span> <span class='st'>"Virgin Islands (UK)"</span>,</span>
<span><span class='st'>"United States Virgin Islands"</span> <span class='op'>=</span> <span class='st'>"Virgin Islands (US)"</span></span>
<span><span class='op'>)</span></span>
<span><span class='co'># PAHO countries without gaul codes </span></span>
<span><span class='co'>#"Bonaire, Saint Eustatius and Saba" </span></span>
<span><span class='co'>#"Curacao"</span></span>
<span><span class='co'>#"Saint Barthelemy", </span></span>
<span><span class='co'>#"Saint Martin", * is this the same country as Sint Maarten?</span></span>
<span><span class='co'>#"Sint Maarten", </span></span>
<span></span>
<span><span class='va'>gaul_codes_world</span> <span class='op'>&lt;-</span> <span class='va'>gaul_codes_world</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>adm_0_name <span class='op'>=</span> <span class='fu'>recode</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='op'>!</span><span class='op'>!</span><span class='op'>!</span><span class='va'>ctry_lookup</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>all_dt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>all_dt</span>, <span class='va'>gaul_codes_world</span>, by<span class='op'>=</span><span class='st'>"adm_0_name"</span>, all.x<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Each data set is then processed into two data hierarchies, primary (A) and secondary (B), with calendar dates added. Epidemiological week and year remain, as these are useful for processing later on.</p>
<p>The case counts are left in cumulative counts at this stage. This may be useful for users who prefer to deal in cumulative counts. here, the calendar start date is fixed at the beginning of epidemiological week one of each year, and the calendar end date is moved forward to account for the cumulative count.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#select columns for master table_A and change to date format</span></span>
<span><span class='va'>all_dt_A</span> <span class='op'>&lt;-</span> <span class='va'>all_dt</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>adm_0_code</span>, <span class='va'>year</span>, <span class='va'>epidemiological_week</span>,</span>
<span>         <span class='va'>calendar_start_date</span>, <span class='va'>calendar_end_date</span>, </span>
<span>         <span class='va'>cum_start_date</span>, <span class='va'>cum_end_date</span>, <span class='va'>cum_interval</span>,</span>
<span>         <span class='va'>dengue_total_cumulative</span>, <span class='va'>source_id</span> </span>
<span>         <span class='op'>)</span><span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>calendar_start_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>calendar_start_date</span><span class='op'>)</span>,</span>
<span>         calendar_end_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>calendar_end_date</span><span class='op'>)</span>, </span>
<span>         cum_start_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>cum_start_date</span><span class='op'>)</span>, </span>
<span>         cum_end_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>cum_end_date</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>all_dt_A_tidy</span> <span class='op'>&lt;-</span> <span class='va'>all_dt_A</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span>, <span class='va'>epidemiological_week</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Check admin codes and fill gaps</span></span>
<span><span class='va'>admin_NA</span> <span class='op'>&lt;-</span> <span class='va'>all_dt_A_tidy</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>adm_0_code</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># *AL: please explain this part - why adm_0_code assigned for Virgin islands only? </span></span>
<span><span class='co'>#all_dt_A_tidy$adm_0_code[all_dt_A_tidy$adm_0_name=="Virgin Islands (UK)"]&lt;-"39"</span></span>
<span><span class='co'>#all_dt_A_tidy$adm_0_code[all_dt_A_tidy$adm_0_name=="Virgin Islands (US)"]&lt;-"258"</span></span>
<span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>all_dt_A_tidy</span>,<span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data/processed_data"</span>, <span class='st'>"PAHO_processed_A.csv"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Dataset B/Secondary dataset, which contains information on : disease severity, serotype, mortality.</span></span>
<span></span>
<span><span class='va'>all_dt_B</span> <span class='op'>&lt;-</span> <span class='va'>all_dt</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>adm_0_code</span>, </span>
<span>         <span class='va'>calendar_start_date</span>, <span class='va'>calendar_end_date</span>, </span>
<span>         <span class='va'>dengue_total_cumulative</span>, <span class='va'>Deaths</span>, <span class='va'>Serotype</span>, <span class='va'>severe_dengue_cumulative</span>, <span class='va'>source_id</span><span class='op'>)</span><span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>rename</span><span class='op'>(</span>dengue_total<span class='op'>=</span><span class='va'>dengue_total_cumulative</span>,</span>
<span>         severe_dengue<span class='op'>=</span><span class='va'>severe_dengue_cumulative</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>calendar_start_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>calendar_start_date</span><span class='op'>)</span>,</span>
<span>         calendar_end_date <span class='op'>=</span> <span class='fu'>ymd</span><span class='op'>(</span><span class='va'>calendar_end_date</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>dengue_total</span><span class='op'>!=</span> <span class='st'>"NA"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>all_dt_B_tidy</span> <span class='op'>&lt;-</span> <span class='va'>all_dt_B</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/replace.html'>replace</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>calendar_start_date</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>admin_NA</span> <span class='op'>&lt;-</span> <span class='va'>all_dt_B_tidy</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>adm_0_code</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#all_dt_B_tidy$adm_0_code[all_dt_B_tidy$adm_0_name=="Virgin Islands (UK)"]&lt;-"39"</span></span>
<span><span class='co'>#all_dt_B_tidy$adm_0_code[all_dt_B_tidy$adm_0_name=="Virgin Islands (US)"]&lt;-"258"</span></span>
<span></span>
<span><span class='va'>all_dt_B_tidy</span><span class='op'>&lt;-</span><span class='va'>all_dt_B_tidy</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>severe_dengue</span>, <span class='va'>dengue_total</span>, <span class='va'>Deaths</span><span class='op'>)</span>,</span>
<span>               names_to<span class='op'>=</span><span class='st'>"dengue_classification"</span>, values_to<span class='op'>=</span><span class='st'>"total"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>all_dt_B_tidy</span> <span class='op'>&lt;-</span> <span class='va'>all_dt_B_tidy</span><span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>all_dt_B_tidy</span><span class='op'>$</span><span class='va'>dengue_classification</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span>, <span class='op'>]</span></span>
<span><span class='va'>all_dt_B_tidy</span> <span class='op'>&lt;-</span> <span class='va'>all_dt_B_tidy</span> <span class='op'>%&gt;%</span>  </span>
<span>  <span class='fu'>select</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>adm_0_code</span>, <span class='va'>calendar_start_date</span>, <span class='va'>calendar_end_date</span>, </span>
<span>         <span class='va'>dengue_classification</span>, <span class='va'>total</span>, <span class='va'>Serotype</span>, <span class='va'>source_id</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='va'>all_dt_B_tidy</span>,<span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data/processed_data/"</span>, <span class='st'>"PAHO_processed_B.csv"</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!-- # Priority setting -->
<!--{r child = 'markdown/sections/02_priority_setting.Rmd', include=FALSE} -->
<!-- # Data revision and imputation (for selected countries) -->
<!--r child = 'markdown/sections/03_filling_gaps.Rmd', include=FALSE} -->
<h1 id="data-revision-and-imputation">Data revision and imputation</h1>
<div class="layout-chunk" data-layout="l-body">
<p><img src="flowchart/PAHO_process_summary.png" width="944" /></p>
</div>
<h2 id="revisions-to-cumulative-count-values">Revisions to cumulative count values</h2>
<p>Since some cumulative counts may be revised down over time, we need to identify the rows in our dataset that contain such values. To achieve this, we will use a for loop. For instance, if the cumulative count for week 5 was initially 100 but revised down to 90 in week 6, we will tag week 5 as having revised down values. Cumulative count for week 5 was compared with all subsequent rows (e.g., week 6 to week 53).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span><span class='op'>$</span><span class='va'>result</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span></span>
<span><span class='co'>#split the dataset by country and year (16 countries * 9 years = 144 datasets) and save them into a list</span></span>
<span><span class='va'>dt_list</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>group_split</span><span class='op'>(</span><span class='op'>)</span> </span>
<span></span>
<span></span>
<span><span class='co'># iterate over each dataset</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>dt_list</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>dt_list</span><span class='op'>[[</span><span class='va'>x</span><span class='op'>]</span><span class='op'>]</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>2</span><span class='op'>)</span> <span class='kw'>next</span></span>
<span>  <span class='co'># iterate over each row</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'># if ith row contains NA, skip this row and go to next row</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dengue_total_cumulative</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'>next</span></span>
<span>    </span>
<span>  <span class='co'># iterate over each subsequent row</span></span>
<span>    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'># skip the row if it's NA and compare with the next row instead</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dengue_total_cumulative</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'>next</span></span>
<span>    </span>
<span>    <span class='co'># compare ith and jth row and if ith row contains value that is larger than a value in jth value, return "TRUE" in "result" column. </span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dengue_total_cumulative</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='va'>df</span><span class='op'>$</span><span class='va'>dengue_total_cumulative</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='va'>dt_list</span><span class='op'>[[</span><span class='va'>x</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>result</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span>        <span class='co'># testing for loop </span></span>
<span>        <span class='co'># print(paste0("I compared ", i, "th row and ", j,  " row of dt_list ", x))</span></span>
<span>    <span class='op'>}</span> </span>
<span>    </span>
<span>  <span class='op'>}</span></span>
<span><span class='op'>}</span></span>
<span>  <span class='co'># the last row is not compared, so set its value to NA</span></span>
<span>  <span class='co'>#dt_list[[x]]$result[nrow(df)] &lt;-NA</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='fu'>view</span><span class='op'>(</span><span class='va'>dt_list</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='co'># merging datasets back</span></span>
<span><span class='va'>data2</span> <span class='op'>&lt;-</span> <span class='fu'>rbindlist</span><span class='op'>(</span><span class='va'>dt_list</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="zero-filling">Zero filling</h2>
<p>When the total sum of weekly = annual count (assuming annual count data is correct), NA values were identified and replaced with count values for the following three use cases.</p>
<h3 id="case-1.-an-entire-year-without-a-case">Case 1. An entire year without a case</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="figure/PAHO/zero%20filling-case1-1.png" width="624" /><img src="figure/PAHO/zero%20filling-case1-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cum_dt</span><span class='op'>$</span><span class='va'>dengue_total_cumulative2</span><span class='op'>)</span> <span class='co'># NA=8679 (decreased from 8978)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
      0       4     440   35908    6259 2363490    8679 </code></pre>
</div>
<h3 id="case-2.-filling-in-values-for-the-weeks-after-the-latest-cumulative-count">Case 2. Filling in values for the weeks after the latest cumulative count</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="figure/PAHO/zero%20filling-case2-1.png" width="624" /><img src="figure/PAHO/zero%20filling-case2-2.png" width="624" /><img src="figure/PAHO/zero%20filling-case2-3.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cum_dt2</span><span class='op'>$</span><span class='va'>dengue_total_cumulative2</span><span class='op'>)</span> <span class='co'># NA=7648 (decreased from 8679)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
      0       6     375   33751    5501 2363490    7648 </code></pre>
</div>
<h3 id="case-3.-duplicated-cumulative-counts-where-nas-exist-in-between">Case 3. Duplicated cumulative counts where NAs exist in between</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="figure/PAHO/zero%20filling-case3-1.png" width="624" /><img src="figure/PAHO/zero%20filling-case3-2.png" width="624" /><img src="figure/PAHO/zero%20filling-case3-3.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cum_dt3</span><span class='op'>$</span><span class='va'>dengue_total_cumulative3</span><span class='op'>)</span> <span class='co'>#NA 7040 (decreased from 7648)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
      0       6     314   32583    5086 2363490    7040 </code></pre>
</div>
<h2 id="imputation">Imputation</h2>
<p>We first attempted using na.approx function of zoo package. Different imputation approaches will be explored later on.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#create epidemiological week 0 row to permit imputation for weeks where epidemiological week has no reported cumulative count.</span></span>
<span><span class='va'>data3</span> <span class='op'>&lt;-</span> <span class='va'>cum_dt3</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>group_modify</span><span class='op'>(</span><span class='op'>~</span> <span class='fu'>add_row</span><span class='op'>(</span><span class='va'>.x</span>,year<span class='op'>=</span><span class='fl'>2014</span><span class='op'>:</span><span class='fl'>2022</span>, </span>
<span>                         epidemiological_week <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                         dengue_total_cumulative3 <span class='op'>=</span> <span class='fl'>0</span> ,.before <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span>, <span class='va'>epidemiological_week</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>data3</span> <span class='op'>&lt;-</span> <span class='va'>data3</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>adm_0_name</span>, <span class='va'>year</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>dengue_na_approx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'>na.approx</span><span class='op'>(</span><span class='va'>dengue_total_cumulative3</span>, na.rm<span class='op'>=</span><span class='cn'>FALSE</span>, rule <span class='op'>=</span> <span class='fl'>2</span>, maxgap<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>    <span class='fu'>mutate</span><span class='op'>(</span>dengue_na_spline <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'>na.spline</span><span class='op'>(</span><span class='va'>dengue_total_cumulative3</span>, na.rm<span class='op'>=</span><span class='cn'>FALSE</span>, maxgap<span class='op'>=</span><span class='fl'>2</span>, method<span class='op'>=</span><span class='st'>"hyman"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># maxgap=2 argument is used to specify that the function can fill in missing values up to two consecutive positions in the vector. rule=2 argument was used to ensure that the interpolated values are always greater than or equal to the observed values in the vector. </span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>data3</span><span class='op'>$</span><span class='va'>dengue_total_cumulative3</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
      0       4     256   31730    4792 2363490    7040 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>data3</span><span class='op'>$</span><span class='va'>dengue_na_approx</span><span class='op'>)</span><span class='co'># NA 6823 (decreased from 7040)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
      0       4     270   31436    4825 2363490    6823 </code></pre>
</div>
<h2 id="threshold-setting-for-imputation">Threshold setting for imputation</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Extract the number of consecutive imputed values for each year and each country</span></span>
<span><span class='va'>consec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rle.html'>rle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>data3</span><span class='op'>$</span><span class='va'>dengue_total_cumulative3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'>#  The 'lengths' column indicates the number of consecutive rows and the 'values' column indicates whether cumulative counts are NAs (values==TRUE) or not.</span></span>
<span></span>
<span><span class='co'># Highlight those year &amp; epidemiological weeks where there are &gt;= 6 imputed values consecutively, so that these can be discarded moving forward (as we have less confidence in imputed values over periods of longer than 6 weeks)</span></span>
<span><span class='va'>consec</span> <span class='op'>&lt;-</span> <span class='va'>consec</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>values2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>lengths</span> <span class='op'>&lt;</span> <span class='fl'>6</span> <span class='op'>&amp;</span> <span class='va'>values</span> <span class='op'>==</span> <span class='cn'>TRUE</span>, <span class='cn'>FALSE</span>, <span class='va'>values</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>consec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>consec</span>, <span class='va'>rep</span>, <span class='va'>consec</span><span class='op'>$</span><span class='va'>lengths</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>data3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>data3</span>, <span class='va'>consec</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Compare the original raw data, revised data, and imputed data. The black dotted line indicates original raw values but were excluded because those were revised down later, the red line indicates the revised &amp; gap filled data (but not yet imputed), and the blue line shows the imputed data.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="figure/PAHO/all%20processes%20result-1.png" width="1920" /></p>
</div>
<h2 id="convert-cumulative-to-incident-counts">Convert cumulative to incident counts</h2>
<p>Prepare dataset for converting cumulative to incident counts. This is more straightforward for data where we have consecutive epidemiological weeks, as a lag column can be created and subtracted from the previous weeks count.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code># A tibble: 7  3
# Groups:   source_cat [4]
  source_cat source_cat2     n
  &lt;chr&gt;      &lt;chr&gt;       &lt;int&gt;
1 Imputed    Imputed       229
2 NA         Revised-NA    151
3 NA         &lt;NA&gt;         6672
4 Raw        Raw         15462
5 Zero       Zero1         287
6 Zero       Zero2        1031
7 Zero       Zero3         608</code></pre>
</div>
<p>Of 24,440 rows, 151 rows have been replaced with NAs following the Revised down stage. In total 2,155 gaps have been filled following the Zero filling and Imputation stage.</p>
<p>Following is an example of comparing different imputation methods for Panama and Argentina. Na.spline() function gives better imputation results than na.approx() when converted to incidence count. Na.spline() will only be included in our final dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="figure/PAHO/imputation%20methods%20comparison-1.png" width="1920" /><img src="figure/PAHO/imputation%20methods%20comparison-2.png" width="1920" /><img src="figure/PAHO/imputation%20methods%20comparison-3.png" width="1920" /><img src="figure/PAHO/imputation%20methods%20comparison-4.png" width="1920" /><img src="figure/PAHO/imputation%20methods%20comparison-5.png" width="1920" /><img src="figure/PAHO/imputation%20methods%20comparison-6.png" width="1920" /></p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--
# Visualisations










## Cumulative plot by country
<div class="layout-chunk" data-layout="l-body">
<img src="figure/PAHO/cumulative%20plot%20for%20each%20country-1.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-2.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-3.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-4.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-5.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-6.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-7.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-8.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-9.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-10.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-11.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-12.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-13.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-14.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-15.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-16.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-17.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-18.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-19.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-20.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-21.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-22.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-23.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-24.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-25.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-26.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-27.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-28.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-29.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-30.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-31.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-32.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-33.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-34.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-35.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-36.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-37.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-38.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-39.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-40.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-41.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-42.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-43.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-44.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-45.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-46.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-47.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-48.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-49.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-50.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-51.png" width="1728" /><img src="figure/PAHO/cumulative%20plot%20for%20each%20country-52.png" width="1728" />

</div>


## Incidence plot by country
<div class="layout-chunk" data-layout="l-body">
<img src="figure/PAHO/incidence%20plot%20for%20each%20country-1.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-2.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-3.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-4.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-5.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-6.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-7.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-8.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-9.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-10.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-11.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-12.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-13.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-14.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-15.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-16.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-17.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-18.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-19.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-20.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-21.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-22.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-23.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-24.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-25.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-26.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-27.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-28.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-29.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-30.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-31.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-32.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-33.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-34.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-35.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-36.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-37.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-38.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-39.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-40.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-41.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-42.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-43.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-44.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-45.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-46.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-47.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-48.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-49.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-50.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-51.png" width="1728" /><img src="figure/PAHO/incidence%20plot%20for%20each%20country-52.png" width="1728" />

</div>


## Updated data coverage

Let's see how the data coverage has been updated so far. The figure below shows the weekly data coverage (2014-2022) by sources (raw, imputed, revised, not available) and country. Imputation filled in the gap, whereas revision may have created more. NA refers to the case when the original raw data was not available; Revised-NA refers to the case when the original raw data was available but has been replaced with NAs because they were revised down over time. 

<div class="layout-chunk" data-layout="l-body">
<img src="figure/PAHO/heatmap-1.png" width="2688" />

</div>


So in summary, what changes have been made to the original raw datasets? 

<div class="layout-chunk" data-layout="l-body">
<img src="figure/PAHO/percent%20data%20updates-1.png" width="1728" />

</div>

```{.r .distill-force-highlighting-css}
```
-->
<div class="sourceCode" id="cb9"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p> Copyright 2023 [The Distill Template Authors]
(https://github.com/distillpub/template/blob/master/AUTHORS) and <a
href="https://www.rstudio.com">RStudio, Inc</a>.</p>
<p>Software licensed under the [Apache License, v2.0]
(https://www.apache.org/licenses/LICENSE-2.0).</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
